Most of the implementation borrowed from zhihu: https://www.zhihu.com/people/yan-ge-ge-32-1
